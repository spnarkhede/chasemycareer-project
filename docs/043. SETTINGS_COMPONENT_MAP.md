# Settings System - Component Map

## ğŸ—ºï¸ Visual Component Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Settings Page                            â”‚
â”‚                      /settings (Main Route)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚      Tabbed Interface         â”‚
                â”‚   (5 Main Sections)           â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
        â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Profile     â”‚      â”‚  Job Search   â”‚      â”‚ Notifications â”‚
â”‚  Preferences  â”‚      â”‚  Preferences  â”‚      â”‚  Preferences  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                       â”‚
        â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Security    â”‚      â”‚     App       â”‚      â”‚               â”‚
â”‚   Settings    â”‚      â”‚Customization  â”‚      â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ File Structure

```
src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ Settings.tsx                          # ğŸ  Main container
â”‚   â”‚   â”œâ”€â”€ Tabs navigation
â”‚   â”‚   â”œâ”€â”€ Tab content areas
â”‚   â”‚   â””â”€â”€ Info card
â”‚   â”‚
â”‚   â””â”€â”€ settings/
â”‚       â”œâ”€â”€ ProfileSettings.tsx               # ğŸ‘¤ Profile tab
â”‚       â”‚   â”œâ”€â”€ Basic Information card
â”‚       â”‚   â””â”€â”€ Location & Localization card
â”‚       â”‚
â”‚       â”œâ”€â”€ JobSearchSettings.tsx             # ğŸ’¼ Job search tab
â”‚       â”‚   â”œâ”€â”€ Job Target & Experience card
â”‚       â”‚   â”œâ”€â”€ Job Search Intensity card
â”‚       â”‚   â””â”€â”€ Resume Format Preference card
â”‚       â”‚
â”‚       â”œâ”€â”€ NotificationSettings.tsx          # ğŸ”” Notifications tab
â”‚       â”‚   â”œâ”€â”€ Notification Preferences card
â”‚       â”‚   â””â”€â”€ Notification Timing card
â”‚       â”‚
â”‚       â”œâ”€â”€ AppCustomization.tsx              # ğŸ¨ Appearance tab
â”‚       â”‚   â”œâ”€â”€ Theme Preference card
â”‚       â”‚   â”œâ”€â”€ Layout Density card
â”‚       â”‚   â””â”€â”€ Preview card
â”‚       â”‚
â”‚       â””â”€â”€ SecuritySettingsPage.tsx          # ğŸ”’ Security tab (existing)
â”‚           â”œâ”€â”€ Password Management
â”‚           â”œâ”€â”€ Multi-Factor Authentication
â”‚           â”œâ”€â”€ Google Account
â”‚           â””â”€â”€ Privacy & Data
â”‚
â”œâ”€â”€ constants/
â”‚   â””â”€â”€ settings.ts                           # ğŸ“Š All constants & helpers
â”‚       â”œâ”€â”€ COUNTRIES
â”‚       â”œâ”€â”€ LANGUAGES
â”‚       â”œâ”€â”€ CURRENCIES
â”‚       â”œâ”€â”€ EXPERIENCE_LEVELS
â”‚       â”œâ”€â”€ JOB_SEARCH_INTENSITIES
â”‚       â”œâ”€â”€ RESUME_FORMATS
â”‚       â”œâ”€â”€ UI_THEMES
â”‚       â”œâ”€â”€ LAYOUT_DENSITIES
â”‚       â”œâ”€â”€ JOB_ROLES
â”‚       â”œâ”€â”€ INDUSTRIES
â”‚       â”œâ”€â”€ JOB_PORTALS
â”‚       â””â”€â”€ Helper functions
â”‚
â””â”€â”€ types/
    â””â”€â”€ index.ts                              # ğŸ“ Type definitions
        â”œâ”€â”€ Profile interface (extended)
        â”œâ”€â”€ PreferredLanguage
        â”œâ”€â”€ PreferredCurrency
        â”œâ”€â”€ ExperienceLevel
        â”œâ”€â”€ JobSearchIntensity
        â”œâ”€â”€ ResumeFormat
        â”œâ”€â”€ UITheme
        â””â”€â”€ LayoutDensity
```

---

## ğŸ¯ Component Breakdown

### 1. Settings.tsx (Main Container)

**Purpose:** Main settings page with tabbed navigation

**Key Features:**
- 5 tab navigation (Profile, Job Search, Notifications, Security, Appearance)
- Responsive tab layout (2 cols mobile, 5 cols desktop)
- Info card at bottom
- Tab state management

**Components Used:**
- `Tabs`, `TabsList`, `TabsTrigger`, `TabsContent`
- `Card`, `CardContent`
- Icons from `lucide-react`

**State:**
```typescript
const [activeTab, setActiveTab] = useState('profile');
```

---

### 2. ProfileSettings.tsx

**Purpose:** Manage profile and localization preferences

**Sections:**

#### Basic Information Card
- Full Name input
- Email display (read-only)

#### Location & Localization Card
- Country dropdown (with flags)
- Language dropdown
- Currency dropdown (with symbols)
- Timezone input

**Key Features:**
- Auto-updates currency and timezone when country changes
- Loading skeleton while fetching data
- Save button with loading state
- Success/error toast notifications

**Components Used:**
- `Card`, `CardHeader`, `CardTitle`, `CardDescription`, `CardContent`
- `Label`, `Input`, `Select`, `Button`
- `Skeleton` for loading states
- Icons: `Globe`, `Languages`, `DollarSign`, `Clock`, `Save`, `Loader2`

**State:**
```typescript
const [loading, setLoading] = useState(true);
const [saving, setSaving] = useState(false);
const [formData, setFormData] = useState({
  full_name: '',
  email: '',
  preferred_country: '',
  preferred_language: 'en',
  preferred_currency: 'USD',
  timezone: '',
});
```

---

### 3. JobSearchSettings.tsx

**Purpose:** Manage job search preferences

**Sections:**

#### Job Target & Experience Card
- Target Role dropdown
- Target Industry dropdown
- Experience Level dropdown

#### Job Search Intensity Card
- Intensity selection (Light/Moderate/High)
- Info box showing tasks per day

#### Resume Format Preference Card
- Format selection dropdown
- Info box with format details

**Key Features:**
- Displays additional info for selected options
- Badge components for highlighting
- Detailed descriptions for each option

**Components Used:**
- `Card`, `CardHeader`, `CardTitle`, `CardDescription`, `CardContent`
- `Label`, `Select`, `Button`, `Badge`
- `Skeleton` for loading states
- Icons: `Target`, `TrendingUp`, `FileText`, `Info`, `Save`, `Loader2`

**State:**
```typescript
const [loading, setLoading] = useState(true);
const [saving, setSaving] = useState(false);
const [formData, setFormData] = useState({
  target_role: '',
  target_industry: '',
  experience_level: '',
  job_search_intensity: 'moderate',
  resume_format_preference: 'ats_standard',
});
```

---

### 4. NotificationSettings.tsx

**Purpose:** Manage notification preferences

**Sections:**

#### Notification Preferences Card
- Email Notifications toggle
- Daily Task Reminders toggle
- Interview Alerts toggle

#### Notification Timing Card
- Information about when notifications are sent
- Bullet list of timing details

**Key Features:**
- Switch components for toggles
- Clear descriptions for each option
- Timing information display

**Components Used:**
- `Card`, `CardHeader`, `CardTitle`, `CardDescription`, `CardContent`
- `Label`, `Switch`, `Button`
- `Skeleton` for loading states
- Icons: `Bell`, `Mail`, `Calendar`, `Save`, `Loader2`

**State:**
```typescript
const [loading, setLoading] = useState(true);
const [saving, setSaving] = useState(false);
const [formData, setFormData] = useState({
  email_notifications: true,
  daily_reminders: true,
  interview_alerts: true,
});
```

---

### 5. AppCustomization.tsx

**Purpose:** Manage app appearance preferences

**Sections:**

#### Theme Preference Card
- Radio group for Light/Dark/System
- Icons for each theme option
- Descriptions

#### Layout Density Card
- Radio group for Compact/Comfortable/Spacious
- Descriptions for each option

#### Preview Card
- Live preview of selected settings
- Sample card with buttons
- Dynamic spacing based on density

**Key Features:**
- Immediate theme application on save
- Live preview of layout density
- Radio button groups
- Visual feedback

**Components Used:**
- `Card`, `CardHeader`, `CardTitle`, `CardDescription`, `CardContent`
- `Label`, `RadioGroup`, `RadioGroupItem`, `Button`
- `Skeleton` for loading states
- Icons: `Palette`, `Layout`, `Save`, `Loader2`

**State:**
```typescript
const [loading, setLoading] = useState(true);
const [saving, setSaving] = useState(false);
const [formData, setFormData] = useState({
  ui_theme: 'system',
  layout_density: 'comfortable',
});
```

---

### 6. SecuritySettingsPage.tsx (Existing)

**Purpose:** Manage security and privacy settings

**Sections:**
- Password Management
- Multi-Factor Authentication
- Google Account Linking
- Privacy & Data Management

**Note:** This component already existed and is integrated into the Settings page.

---

## ğŸ”„ Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚
â”‚   Action    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component  â”‚
â”‚   State     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase   â”‚
â”‚   Update    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Database   â”‚
â”‚  (profiles) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Toast     â”‚
â”‚Notification â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Detailed Flow

1. **User Action**
   - User changes a setting value
   - Form state updates immediately

2. **Save Action**
   - User clicks "Save Changes" button
   - `saving` state set to `true`
   - Button shows loading spinner

3. **Database Update**
   - Supabase update query executed
   - Data sent to `profiles` table
   - Filtered by user ID

4. **Response Handling**
   - Success: Show success toast
   - Error: Show error toast, log error
   - `saving` state set to `false`

5. **UI Update**
   - Button returns to normal state
   - Settings remain in form
   - User can continue editing

---

## ğŸ¨ UI Components Used

### shadcn/ui Components
- âœ… `Card`, `CardHeader`, `CardTitle`, `CardDescription`, `CardContent`
- âœ… `Tabs`, `TabsList`, `TabsTrigger`, `TabsContent`
- âœ… `Button`
- âœ… `Input`
- âœ… `Label`
- âœ… `Select`, `SelectTrigger`, `SelectValue`, `SelectContent`, `SelectItem`
- âœ… `Switch`
- âœ… `RadioGroup`, `RadioGroupItem`
- âœ… `Badge`
- âœ… `Skeleton`

### Icons (lucide-react)
- âš™ï¸ `Settings` - Main settings icon
- ğŸ‘¤ `User` - Profile tab
- ğŸ’¼ `Briefcase` - Job search tab
- ğŸ”” `Bell` - Notifications tab
- ğŸ”’ `Shield` - Security tab
- ğŸ¨ `Palette` - Appearance tab
- ğŸŒ `Globe` - Country/location
- ğŸ—£ï¸ `Languages` - Language preference
- ğŸ’µ `DollarSign` - Currency
- ğŸ• `Clock` - Timezone
- ğŸ¯ `Target` - Job target
- ğŸ“ˆ `TrendingUp` - Job intensity
- ğŸ“„ `FileText` - Resume format
- ğŸ“§ `Mail` - Email notifications
- ğŸ“… `Calendar` - Interview alerts
- ğŸ–¼ï¸ `Layout` - Layout density
- ğŸ’¾ `Save` - Save button
- â³ `Loader2` - Loading spinner
- â„¹ï¸ `Info` - Information icon

---

## ğŸ”— Integration Points

### AuthContext
```typescript
const { user, profile } = useAuth();
```
- Provides current user data
- Provides profile with preferences
- Used in all settings components

### Supabase
```typescript
import { supabase } from '@/db/supabase';
```
- Database queries
- Update operations
- Real-time subscriptions (future)

### Toast Notifications
```typescript
import { toast } from 'sonner';
```
- Success messages
- Error messages
- User feedback

### React Router
```typescript
import { useNavigate } from 'react-router-dom';
```
- Navigation between tabs
- Redirect after actions

---

## ğŸ“± Responsive Design

### Desktop (â‰¥1024px)
- 5-column tab layout
- Side-by-side cards
- Full labels and descriptions
- Larger form inputs

### Tablet (768px - 1023px)
- 3-column tab layout
- Stacked cards
- Full labels
- Medium form inputs

### Mobile (<768px)
- 2-column tab layout
- Stacked cards
- Icon-only tabs (with tooltips)
- Full-width form inputs
- Larger touch targets

---

## ğŸ¯ Key Features

### Smart Defaults
- Country selection auto-updates currency and timezone
- Default values for all preferences
- Fallback to system preferences

### Validation
- Check constraints in database
- Client-side validation
- Error messages for invalid input

### Loading States
- Skeleton loaders while fetching
- Loading spinners on save
- Disabled buttons during operations

### User Feedback
- Success toast on save
- Error toast on failure
- Clear error messages
- Confirmation dialogs (security actions)

### Accessibility
- Proper label associations
- Keyboard navigation
- ARIA attributes
- Focus management

---

## ğŸš€ Performance

### Optimizations
- Lazy loading of settings components
- Debounced auto-save (future)
- Optimistic UI updates (future)
- Cached preference data

### Bundle Size
- Tree-shakeable constants
- Lazy-loaded tabs
- Minimal dependencies
- Efficient re-renders

---

## ğŸ§ª Testing Considerations

### Unit Tests
- Component rendering
- State management
- Form validation
- Helper functions

### Integration Tests
- Database operations
- Toast notifications
- Navigation
- Theme switching

### E2E Tests
- Complete settings flow
- Save and reload
- Cross-tab navigation
- Mobile responsiveness

---

## ğŸ“š Related Documentation

- [Full Settings Documentation](./SETTINGS_SYSTEM.md)
- [Quick Reference Guide](./SETTINGS_QUICK_REFERENCE.md)
- [Database Migration](./supabase/migrations/00005_add_user_preferences.sql)
- [Constants Reference](./src/constants/settings.ts)
- [Type Definitions](./src/types/index.ts)

---

**Last Updated:** 2025-12-09  
**Version:** 1.0.0
