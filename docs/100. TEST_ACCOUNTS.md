# Test Accounts & Authentication Guide

## ‚ö†Ô∏è IMPORTANT: Create Test Users First!

**Before you can log in, you MUST create the test user accounts using the test user creation tool.**

### Quick Setup (3 Steps):
1. Navigate to `/admin/create-test-users`
2. Click "Create Test Users" button
3. Wait for success message - Done!

See `HOW_TO_LOGIN.md` for detailed step-by-step instructions.

---

## üîê Test User Accounts

Two test accounts have been created for development and testing purposes:

### Admin Account
- **Email**: `admin@jobtracker.test`
- **Password**: `AdminTest123!@#`
- **Role**: Administrator
- **Full Name**: Admin User
- **Permissions**: Full access to all features including admin panel

### Regular User Account
- **Email**: `user@jobtracker.test`
- **Password**: `UserTest123!@#`
- **Role**: User
- **Full Name**: Test User
- **Permissions**: Standard user access

## üöÄ How to Login

### STEP 1: Create Test Users (Required First Time)

1. Navigate to `/admin/create-test-users`
2. Click the "Create Test Users" button
3. Wait for the success message showing both accounts were created
4. Now you can proceed to login

**Why this step is needed:**
- Test users must be created using Supabase's Admin API
- This ensures proper password hashing and authentication setup
- The tool will delete and recreate users if they already exist

### STEP 2: Login with Test Account

1. Navigate to the login page: `/login`
2. Enter one of the test account credentials above
3. Click "Sign In"
4. You will be redirected to the dashboard

### STEP 3: Google OAuth (Optional)

1. Navigate to the login page: `/login`
2. Click "Continue with Google" button (with Google logo)
3. Follow Google's authentication flow
4. You will be redirected back to the application

**Note**: Google OAuth requires proper configuration in Supabase dashboard. See setup instructions below.

## üîß Google OAuth Setup

### Prerequisites
- Google Cloud Console account
- Supabase project

### Step 1: Configure Google Cloud Console

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select existing one
3. Navigate to "APIs & Services" > "Credentials"
4. Click "Create Credentials" > "OAuth 2.0 Client ID"
5. Configure OAuth consent screen if not done already
6. Select "Web application" as application type
7. Add authorized redirect URIs:
   ```
   https://itazzlbcxisavqxvkmoe.supabase.co/auth/v1/callback
   ```
8. Copy the Client ID and Client Secret

### Step 2: Configure Supabase

1. Go to your [Supabase Dashboard](https://supabase.com/dashboard)
2. Select your project: `itazzlbcxisavqxvkmoe`
3. Navigate to "Authentication" > "Providers"
4. Find "Google" in the list and click to configure
5. Enable Google provider
6. Paste your Google Client ID
7. Paste your Google Client Secret
8. Save the configuration

### Step 3: Test the Integration

1. Go to your application's login page
2. Click "Continue with Google"
3. You should be redirected to Google's login page
4. After successful authentication, you'll be redirected back to the dashboard

## üé® UI Improvements

### Google Logo
The login and signup pages now feature the official Google logo (colorful G icon) instead of a generic Chrome icon. This provides:
- Better brand recognition
- Professional appearance
- Clear indication of Google authentication

### Button States
- **Normal**: Shows Google logo with "Continue with Google" text
- **Loading**: Shows spinner animation while processing
- **Disabled**: Grayed out when another action is in progress

## üîí Security Features

### Password Requirements
When creating a new account, passwords must meet these requirements:
- ‚úÖ At least 12 characters long
- ‚úÖ Contains at least one lowercase letter
- ‚úÖ Contains at least one uppercase letter
- ‚úÖ Contains at least one number
- ‚úÖ Contains at least one special character

### Rate Limiting
- Failed login attempts are tracked
- After multiple failed attempts, accounts are temporarily locked
- Prevents brute force attacks

### Session Management
- Secure HTTP-only cookies
- Session tracking with device info and IP address
- Ability to view and revoke active sessions

## üêõ Troubleshooting

### Issue: Google Login Not Working

**Symptoms**: Clicking "Continue with Google" shows an error or doesn't redirect

**Solutions**:
1. Verify Google OAuth is configured in Supabase dashboard
2. Check that redirect URI matches exactly in Google Cloud Console
3. Ensure Google provider is enabled in Supabase
4. Check browser console for error messages
5. Verify Supabase URL and anon key in `.env` file

### Issue: Email/Password Login Fails

**Symptoms**: "Invalid credentials" error when logging in

**Solutions**:
1. Verify you're using the correct test account credentials
2. Check that test users were created successfully:
   ```sql
   SELECT email, role FROM profiles;
   ```
3. Ensure email confirmation is not required for test accounts
4. Check Supabase logs for authentication errors

### Issue: Account Creation Not Working

**Symptoms**: Signup form shows errors or doesn't create account

**Solutions**:
1. Verify password meets all requirements (12+ chars, uppercase, lowercase, number, special char)
2. Check that email is not already registered
3. Ensure Supabase email confirmation is configured
4. Check browser console for validation errors
5. Verify Supabase connection in network tab

### Issue: Redirected to Wrong Page After Login

**Symptoms**: After login, not redirected to dashboard

**Solutions**:
1. Check AuthContext is properly configured
2. Verify routes are set up correctly in `routes.tsx`
3. Ensure `/auth/callback` route exists for OAuth
4. Check browser console for navigation errors

## üìù Development Notes

### Test Account Cleanup
These test accounts are for development only. In production:
1. Remove or disable test accounts
2. Delete the migration file `00099_create_test_users.sql`
3. Use proper user registration flow
4. Implement email verification

### OAuth Callback Flow
The OAuth callback flow works as follows:
1. User clicks "Continue with Google"
2. `authApi.signInWithGoogle()` initiates OAuth flow
3. User authenticates with Google
4. Google redirects to `/auth/callback`
5. `OAuthCallback` component processes the callback
6. Session is created and user is redirected to dashboard

### Profile Creation
When a user signs up or logs in with Google:
1. Supabase Auth creates user in `auth.users`
2. Trigger function `handle_new_user()` fires
3. Profile is automatically created in `profiles` table
4. First user gets admin role, subsequent users get user role

## üîó Related Files

### Authentication
- `src/db/auth-api.ts` - Authentication API functions
- `src/pages/auth/LoginPage.tsx` - Login page component
- `src/pages/auth/SignUpPage.tsx` - Signup page component
- `src/pages/auth/OAuthCallback.tsx` - OAuth callback handler
- `src/contexts/AuthContext.tsx` - Authentication context

### Database
- `supabase/migrations/00001_create_profiles_table.sql` - Profiles table
- `supabase/migrations/00003_create_auth_security_tables.sql` - Security tables
- `supabase/migrations/00099_create_test_users.sql` - Test accounts

### UI Components
- `src/components/icons/GoogleIcon.tsx` - Google logo SVG

## ‚úÖ Testing Checklist

Before deploying to production, verify:
- [ ] Google OAuth is properly configured
- [ ] Test accounts can log in successfully
- [ ] New users can sign up with email/password
- [ ] Google login creates proper user profiles
- [ ] Password requirements are enforced
- [ ] Rate limiting works correctly
- [ ] Sessions are tracked properly
- [ ] Users are redirected correctly after login
- [ ] Logout works properly
- [ ] Admin and user roles have correct permissions

## üéØ Quick Start

1. **Login with test account**:
   ```
   Email: admin@jobtracker.test
   Password: AdminTest123!@#
   ```

2. **Or create a new account**:
   - Go to `/signup`
   - Fill in the form with a strong password
   - Check your email for verification (if enabled)

3. **Or use Google OAuth**:
   - Click "Continue with Google"
   - Authenticate with your Google account
   - You'll be automatically logged in

## üìû Support

If you encounter any issues:
1. Check the troubleshooting section above
2. Review browser console for errors
3. Check Supabase logs in the dashboard
4. Verify environment variables in `.env`
5. Ensure all migrations have been applied

---

**Last Updated**: 2025-12-09
**Version**: 1.0.0
