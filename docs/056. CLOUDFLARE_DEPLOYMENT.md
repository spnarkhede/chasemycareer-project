# ‚òÅÔ∏è Complete Cloudflare Pages Deployment Guide

## Prerequisites

- Cloudflare account (free tier works)
- GitHub repository with your code
- Supabase project set up
- Domain name (optional, for custom domain)

---

## Method 1: Deploy via Cloudflare Dashboard (Recommended)

### Step 1: Prepare Your Repository

1. **Push code to GitHub:**
```bash
cd /workspace/chasemycareer
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/chase-my-career.git
git push -u origin main
```

### Step 2: Create Cloudflare Pages Project

1. Go to https://dash.cloudflare.com/
2. Click "Workers & Pages" in the left sidebar
3. Click "Create application"
4. Click "Pages" tab
5. Click "Connect to Git"
6. Authorize Cloudflare to access your GitHub
7. Select your repository: `chase-my-career`
8. Click "Begin setup"

### Step 3: Configure Build Settings

**Project name:** `chase-my-career`

**Production branch:** `main`

**Build settings:**
- **Framework preset:** Vite
- **Build command:** `cd frontend && npm run build`
- **Build output directory:** `frontend/dist`
- **Root directory:** `/` (leave empty or set to root)

**Environment variables (build):**
```
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here
VITE_GOOGLE_CLIENT_ID=your-google-client-id
NODE_VERSION=18
```

### Step 4: Deploy

1. Click "Save and Deploy"
2. Wait for build to complete (~2-3 minutes)
3. Your app will be live at: `https://chase-my-career.pages.dev`

---

## Method 2: Deploy via Wrangler CLI

### Step 1: Install Wrangler

```bash
npm install -g wrangler
```

### Step 2: Login to Cloudflare

```bash
wrangler login
```

This will open a browser window for authentication.

### Step 3: Build Your Application

```bash
cd /workspace/chasemycareer/frontend
npm install
npm run build
```

### Step 4: Deploy to Cloudflare Pages

```bash
wrangler pages deploy dist --project-name=chase-my-career
```

**First time deployment:**
- Wrangler will ask to create a new project
- Confirm project name: `chase-my-career`
- Choose production branch: `main`

### Step 5: Set Environment Variables

```bash
# Set Supabase URL
wrangler pages secret put VITE_SUPABASE_URL --project-name=chase-my-career
# Paste your Supabase URL when prompted

# Set Supabase Anon Key
wrangler pages secret put VITE_SUPABASE_ANON_KEY --project-name=chase-my-career
# Paste your Supabase anon key when prompted

# Set Google Client ID (optional)
wrangler pages secret put VITE_GOOGLE_CLIENT_ID --project-name=chase-my-career
# Paste your Google client ID when prompted
```

---

## Method 3: Direct Upload (No Git)

### Step 1: Build Application

```bash
cd /workspace/chasemycareer/frontend
npm install
npm run build
```

### Step 2: Upload via Dashboard

1. Go to Cloudflare Dashboard ‚Üí Workers & Pages
2. Click "Create application" ‚Üí "Pages" ‚Üí "Upload assets"
3. Enter project name: `chase-my-career`
4. Drag and drop the `dist` folder
5. Click "Deploy site"

---

## Configure Custom Domain (www.chasemycareer.com)

### Step 1: Add Domain to Cloudflare

**If domain is already on Cloudflare:**
1. Go to your Pages project
2. Click "Custom domains" tab
3. Click "Set up a custom domain"
4. Enter: `www.chasemycareer.com`
5. Click "Continue"
6. Cloudflare will automatically configure DNS

**If domain is NOT on Cloudflare:**
1. Add your domain to Cloudflare first
2. Update nameservers at your registrar
3. Wait for nameserver propagation (24-48 hours)
4. Then follow steps above

### Step 2: Add Root Domain

1. Click "Set up a custom domain" again
2. Enter: `chasemycareer.com`
3. Click "Continue"
4. Cloudflare will configure DNS automatically

### Step 3: Configure DNS Records

Cloudflare should auto-configure, but verify these records exist:

**For www subdomain:**
```
Type: CNAME
Name: www
Target: chase-my-career.pages.dev
Proxy status: Proxied (orange cloud)
```

**For root domain:**
```
Type: CNAME
Name: @
Target: chase-my-career.pages.dev
Proxy status: Proxied (orange cloud)
```

### Step 4: Set Primary Domain

1. In Custom domains tab
2. Click the three dots next to `www.chasemycareer.com`
3. Select "Set as primary domain"
4. This will redirect `chasemycareer.com` ‚Üí `www.chasemycareer.com`

### Step 5: Update Supabase Redirect URLs

1. Go to Supabase Dashboard ‚Üí Authentication ‚Üí URL Configuration
2. Add these URLs:
   - `https://www.chasemycareer.com/**`
   - `https://chasemycareer.com/**`
3. Update OAuth redirect URLs in Google Cloud Console (if using Google OAuth)

---

## Cloudflare Pages Configuration

### Create `_redirects` file

Create `frontend/public/_redirects`:

```
# SPA fallback
/*    /index.html   200

# Force HTTPS
http://:splat  https://:splat  301!

# Redirect root to www
https://chasemycareer.com/*  https://www.chasemycareer.com/:splat  301
```

### Create `_headers` file

Create `frontend/public/_headers`:

```
/*
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  Referrer-Policy: strict-origin-when-cross-origin
  Permissions-Policy: geolocation=(), microphone=(), camera=()
  X-XSS-Protection: 1; mode=block

/assets/*
  Cache-Control: public, max-age=31536000, immutable

/*.js
  Cache-Control: public, max-age=31536000, immutable

/*.css
  Cache-Control: public, max-age=31536000, immutable
```

---

## Automated Deployment with GitHub Actions

### Step 1: Get Cloudflare API Token

1. Go to https://dash.cloudflare.com/profile/api-tokens
2. Click "Create Token"
3. Use "Edit Cloudflare Workers" template
4. Or create custom token with permissions:
   - Account - Cloudflare Pages - Edit
5. Copy the token

### Step 2: Get Account ID

1. Go to Cloudflare Dashboard
2. Click on "Workers & Pages"
3. Your Account ID is shown in the right sidebar
4. Copy it

### Step 3: Add GitHub Secrets

Go to GitHub repository ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions

Add these secrets:
- `CLOUDFLARE_API_TOKEN`: Your API token
- `CLOUDFLARE_ACCOUNT_ID`: Your account ID
- `VITE_SUPABASE_URL`: Your Supabase URL
- `VITE_SUPABASE_ANON_KEY`: Your Supabase anon key

### Step 4: GitHub Actions Workflow

The workflow is already created in `.github/workflows/ci-cd.yml`

Push to main branch to trigger deployment:
```bash
git add .
git commit -m "Deploy to Cloudflare Pages"
git push origin main
```

---

## Deployment Scripts

### Quick Deploy Script

Create `deploy-cloudflare.sh`:

```bash
#!/bin/bash

echo "‚òÅÔ∏è  Deploying Chase My Career to Cloudflare Pages..."

# Navigate to frontend
cd frontend

# Install dependencies
echo "üì¶ Installing dependencies..."
npm ci

# Run tests
echo "üß™ Running tests..."
npm run test:run

# Run linter
echo "üîç Running linter..."
npm run lint

# Build application
echo "üèóÔ∏è  Building application..."
npm run build

# Deploy to Cloudflare Pages
echo "üöÄ Deploying to Cloudflare Pages..."
wrangler pages deploy dist --project-name=chase-my-career --branch=main

echo "‚úÖ Deployment complete!"
```

Make it executable:
```bash
chmod +x deploy-cloudflare.sh
```

Run it:
```bash
./deploy-cloudflare.sh
```

### Preview Deploy Script

Create `deploy-cloudflare-preview.sh`:

```bash
#!/bin/bash

echo "‚òÅÔ∏è  Deploying preview to Cloudflare Pages..."

cd frontend
npm ci
npm run build
wrangler pages deploy dist --project-name=chase-my-career --branch=preview

echo "‚úÖ Preview deployment complete!"
```

---

## Wrangler Configuration

Create `wrangler.toml` in `frontend/` directory:

```toml
name = "chase-my-career"
compatibility_date = "2024-01-01"

[site]
bucket = "./dist"

[env.production]
name = "chase-my-career"
route = "www.chasemycareer.com/*"

[env.preview]
name = "chase-my-career-preview"
```

---

## Environment Variables Management

### Set via Dashboard

1. Go to Cloudflare Dashboard ‚Üí Workers & Pages
2. Select your project
3. Click "Settings" tab
4. Click "Environment variables"
5. Add variables for Production and Preview

### Set via CLI

```bash
# Production environment
wrangler pages secret put VITE_SUPABASE_URL --project-name=chase-my-career --env=production

# Preview environment
wrangler pages secret put VITE_SUPABASE_URL --project-name=chase-my-career --env=preview
```

### List Environment Variables

```bash
wrangler pages secret list --project-name=chase-my-career
```

---

## Cloudflare Features

### Enable Web Analytics

1. Go to Cloudflare Dashboard ‚Üí Analytics ‚Üí Web Analytics
2. Click "Add a site"
3. Enter: `www.chasemycareer.com`
4. Copy the analytics script
5. Add to `frontend/index.html` before `</body>`:

```html
<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "YOUR_TOKEN"}'></script>
```

### Enable Caching

Cloudflare automatically caches static assets. Configure in:

1. Dashboard ‚Üí Caching ‚Üí Configuration
2. Set caching level: Standard
3. Browser Cache TTL: 4 hours
4. Enable "Always Online"

### Enable Security Features

1. **SSL/TLS:** Set to "Full (strict)"
2. **Always Use HTTPS:** Enable
3. **Automatic HTTPS Rewrites:** Enable
4. **Minimum TLS Version:** 1.2
5. **TLS 1.3:** Enable

### Enable DDoS Protection

1. Go to Security ‚Üí DDoS
2. Enable "HTTP DDoS Attack Protection"
3. Enable "Advanced DDoS Protection" (if available)

### Configure Firewall Rules

1. Go to Security ‚Üí WAF
2. Enable "Cloudflare Managed Ruleset"
3. Add custom rules if needed

---

## Troubleshooting

### Build Fails

**Issue:** Build fails with "command not found"

**Solution:**
Update build command to:
```
cd frontend && npm ci && npm run build
```

### Environment Variables Not Working

**Issue:** App can't connect to Supabase

**Solution:**
1. Verify variables are set in Cloudflare Dashboard
2. Ensure variable names start with `VITE_`
3. Redeploy after adding variables
4. Check that variables are set for correct environment (Production/Preview)

### Custom Domain Not Working

**Issue:** Domain shows error or doesn't resolve

**Solution:**
1. Verify domain is added to Cloudflare
2. Check nameservers are pointing to Cloudflare
3. Verify DNS records are correct
4. Wait 24-48 hours for propagation
5. Check DNS with: `dig www.chasemycareer.com`

### 404 on Page Refresh

**Issue:** Refreshing page shows 404

**Solution:**
- Ensure `_redirects` file exists in `public/` folder
- Content should be: `/*    /index.html   200`
- Redeploy after adding the file

---

## Rollback Deployment

### Via Dashboard

1. Go to Cloudflare Dashboard ‚Üí Workers & Pages
2. Select your project
3. Click "Deployments" tab
4. Find the previous working deployment
5. Click "Rollback to this deployment"

### Via CLI

```bash
# List deployments
wrangler pages deployment list --project-name=chase-my-career

# Rollback to specific deployment
wrangler pages deployment rollback [deployment-id] --project-name=chase-my-career
```

---

## Performance Optimization

### Enable Argo Smart Routing

1. Go to Traffic ‚Üí Argo
2. Enable Argo Smart Routing
3. Cost: $5/month + $0.10/GB

### Enable Cloudflare Images (for image optimization)

1. Go to Images
2. Enable Cloudflare Images
3. Update image URLs to use Cloudflare Images

### Enable Zaraz (Tag Manager)

1. Go to Zaraz
2. Add analytics tools without impacting performance

---

## Monitoring & Logs

### View Deployment Logs

```bash
wrangler pages deployment tail --project-name=chase-my-career
```

### View Real-time Logs

1. Go to Cloudflare Dashboard ‚Üí Workers & Pages
2. Select your project
3. Click "Logs" tab
4. View real-time logs

### Set up Alerts

1. Go to Notifications
2. Create alert for:
   - Deployment failures
   - High error rates
   - Traffic spikes

---

## Cost Estimation

### Cloudflare Pages Free Tier
- ‚úÖ Unlimited requests
- ‚úÖ Unlimited bandwidth
- ‚úÖ 500 builds/month
- ‚úÖ Automatic HTTPS
- ‚úÖ Preview deployments
- ‚úÖ Custom domains
- ‚úÖ DDoS protection
- ‚úÖ Web Analytics

### Cloudflare Pages Pro ($20/month)
- ‚úÖ Everything in Free
- ‚úÖ 5,000 builds/month
- ‚úÖ Concurrent builds
- ‚úÖ Advanced analytics

**Recommendation:** Free tier is sufficient for most projects.

---

## Post-Deployment Checklist

- [ ] Application is accessible at Cloudflare Pages URL
- [ ] Custom domain is configured (if applicable)
- [ ] SSL certificate is active (HTTPS works)
- [ ] Environment variables are set correctly
- [ ] User registration works
- [ ] Login/logout works
- [ ] Database connections work
- [ ] OAuth flows work (if configured)
- [ ] All pages are accessible
- [ ] No console errors
- [ ] Caching is working
- [ ] Security features enabled
- [ ] Analytics enabled (optional)

---

## Useful Commands

```bash
# Deploy to production
wrangler pages deploy dist --project-name=chase-my-career --branch=main

# Deploy preview
wrangler pages deploy dist --project-name=chase-my-career --branch=preview

# List deployments
wrangler pages deployment list --project-name=chase-my-career

# View logs
wrangler pages deployment tail --project-name=chase-my-career

# Delete deployment
wrangler pages deployment delete [deployment-id] --project-name=chase-my-career

# List projects
wrangler pages project list

# Get project info
wrangler pages project get chase-my-career
```

---

## Comparison: Cloudflare Pages vs Vercel

| Feature | Cloudflare Pages | Vercel |
|---------|------------------|--------|
| Free Bandwidth | Unlimited | 100 GB/month |
| Free Builds | 500/month | Unlimited |
| Custom Domains | Unlimited | Unlimited |
| Edge Network | 275+ cities | 100+ cities |
| DDoS Protection | Included | Included |
| Analytics | Free | Paid ($20/mo) |
| Build Time | ~2-3 min | ~2-3 min |
| Cold Start | None (static) | None (static) |

**Recommendation:** Cloudflare Pages for unlimited bandwidth, Vercel for better DX.

---

## Support

- **Cloudflare Docs:** https://developers.cloudflare.com/pages/
- **Cloudflare Community:** https://community.cloudflare.com/
- **Wrangler Docs:** https://developers.cloudflare.com/workers/wrangler/

---

**Last Updated:** January 2, 2026  
**Version:** 1.0.0  
**Status:** Production Ready
