# Routing Configuration

This document explains how routing is configured in the Chase My Career application and how to ensure direct URL access works correctly.

## Overview

The application uses **React Router v6** for client-side routing. All routes are defined in `src/routes.tsx` and rendered in `src/App.tsx`.

## Route Configuration

### Public Routes (No Authentication Required)
- `/` - Landing page
- `/login` - Login page (eagerly loaded)
- `/signup` - Sign up page (eagerly loaded)
- `/forgot-password` - Password reset request
- `/reset-password` - Password reset confirmation
- `/auth/callback` - OAuth callback handler
- `/privacy-policy` - Privacy policy
- `/terms-of-service` - Terms of service
- `/admin/create-test-users` - Test user creation utility

### Protected Routes (Authentication Required)
- `/dashboard` - User dashboard
- `/50-day-plan` - 50-day career plan
- `/job-tracker` - Job application tracker
- `/interviews` - Interview management
- `/networking` - Networking contacts
- `/interview-practice` - Interview practice tools
- `/calendar` - Job search calendar
- `/google-calendar` - Google Calendar integration
- `/day/:dayNumber` - Daily task details
- `/congratulations` - Completion celebration
- `/settings` - User settings
- `/settings/security` - Security settings
- `/privacy-settings` - Privacy preferences
- `/onboarding` - Initial user onboarding

### Admin Routes (Admin Role Required)
- `/admin` - Admin dashboard

## Performance Optimization

### Eager Loading
Critical pages that users might access directly are **eagerly loaded** to prevent any loading delay:
- Landing page
- Login page
- Sign up page
- Password reset pages

### Lazy Loading
All other pages are **lazy loaded** using React's `lazy()` to improve initial bundle size and load time.

## Direct URL Access

### Development Environment
Vite's dev server automatically handles SPA routing. When you access any route directly (e.g., `http://localhost:5173/login`), Vite serves `index.html` and React Router handles the routing.

### Production Deployment

#### For Netlify
The `public/_redirects` file ensures all routes serve `index.html`:
```
/* /index.html 200
```

#### For Vercel
The `vercel.json` file configures rewrites:
```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

#### For Other Hosting Providers
Ensure your hosting provider is configured to:
1. Serve `index.html` for all routes (not just `/`)
2. Return HTTP 200 status (not 404) for all routes
3. Let React Router handle the client-side routing

## Testing Direct URL Access

### Local Development
1. Start the dev server: `pnpm run dev`
2. Open your browser and directly navigate to:
   - `http://localhost:5173/login`
   - `http://localhost:5173/signup`
   - `http://localhost:5173/admin/create-test-users`
3. Verify that the correct page loads immediately without showing the homepage first

### Production Build
1. Build the app: `pnpm run build`
2. Preview the build: `pnpm run preview`
3. Test the same URLs as above
4. Verify no 404 errors in the browser console

### After Deployment
1. Navigate directly to: `https://yourdomain.com/login`
2. Refresh the page while on `/login`
3. Verify the login page loads correctly
4. Check browser console for any routing errors

## Common Issues and Solutions

### Issue: Direct URL shows 404
**Solution**: Configure your hosting provider to serve `index.html` for all routes.

### Issue: Homepage flashes before correct page
**Possible Causes**:
1. Route is lazy-loaded → Consider eager loading critical routes
2. Auth state is initializing → This is expected and brief
3. Suspense fallback is showing → This is expected for lazy-loaded routes

### Issue: Protected routes redirect to login
**Expected Behavior**: This is correct! Protected routes should redirect unauthenticated users to `/login`.

### Issue: Routes work in dev but not in production
**Solution**: Verify deployment configuration files (`_redirects` or `vercel.json`) are included in the build output.

## Route Priority

Routes are matched in the order they appear in `src/routes.tsx`. The catch-all route (`*`) is defined last to redirect any unmatched routes to the homepage:

```tsx
<Route path="*" element={<Navigate to="/" replace />} />
```

## Adding New Routes

1. Import or lazy-load the component in `src/routes.tsx`
2. Add the route configuration to the `routes` array
3. Set `protected: true` if authentication is required
4. Set `requireAdmin: true` if admin role is required
5. Set `visible: false` to hide from navigation menus
6. Update `hideHeader` logic in `src/App.tsx` if the page shouldn't show the header

Example:
```tsx
{
  name: 'New Page',
  path: '/new-page',
  Component: NewPage,
  protected: true,
  visible: false
}
```

## Debugging Tips

1. **Check Browser Console**: Look for routing errors or 404s
2. **Check Network Tab**: Verify `index.html` is served for all routes
3. **Check React DevTools**: Verify correct component is rendered
4. **Check Route Definitions**: Ensure path matches exactly (case-sensitive)
5. **Check Auth State**: Protected routes require authentication

## Additional Resources

- [React Router Documentation](https://reactrouter.com/)
- [Vite SPA Fallback](https://vitejs.dev/guide/backend-integration.html)
- [Netlify Redirects](https://docs.netlify.com/routing/redirects/)
- [Vercel Rewrites](https://vercel.com/docs/concepts/projects/project-configuration#rewrites)
